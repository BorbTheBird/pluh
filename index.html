<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Controls with Tone.js</title>
    <style>
        .slider-container {
            margin: 20px 0;
        }
        .slider-container input[type="range"] {
            width: 300px; /* Adjust the length of the sliders */
        }
    </style>
</head>
<body>
    <h1>Pluh</h1>
    <img src="pluh.jpg" alt="Pluh" />
    <p>Look at him, he's so pluh</p>

    <button id="start">Start Audio</button>

    <div class="slider-container">
        <label for="pitch">Pitch:</label>
        <input type="range" id="pitch" min="0.5" max="2" step="0.01" value="1">
        <span id="pitch-value">1</span>
    </div>

    <div class="slider-container">
        <label for="speed">Speed:</label>
        <input type="range" id="speed" min="0.5" max="2" step="0.01" value="1">
        <span id="speed-value">1</span>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.38/Tone.min.js"></script>
    <script>
        let player;
        let pitchShift;
        let playbackRateControl;

        // Ensure Tone.js context is started by user interaction
        document.getElementById('start').addEventListener('click', () => {
            Tone.start().then(() => {
                if (!player) {
                    // Create and load the player
                    player = new Tone.Player('soun.mp3').toDestination();

                    // Create pitch shift and playback rate nodes
                    pitchShift = new Tone.PitchShift().toDestination();
                    playbackRateControl = new Tone.Gain().toDestination();

                    // Connect nodes
                    player.connect(pitchShift);
                    pitchShift.connect(playbackRateControl);

                    // Initialize sliders
                    const pitchSlider = document.getElementById('pitch');
                    const speedSlider = document.getElementById('speed');
                    const pitchValue = document.getElementById('pitch-value');
                    const speedValue = document.getElementById('speed-value');

                    function updateAudio() {
                        const pitch = pitchSlider.value;
                        const speed = speedSlider.value;

                        // Update pitch and speed
                        pitchShift.pitch = pitch;
                        playbackRateControl.gain.value = speed;

                        // Update displayed values
                        pitchValue.textContent = pitch;
                        speedValue.textContent = speed;
                    }

                    pitchSlider.addEventListener('input', updateAudio);
                    speedSlider.addEventListener('input', updateAudio);

                    updateAudio(); // Initialize values

                    // Start playback
                    player.start();
                }
            }).catch(err => {
                console.error('Error starting Tone.js:', err);
            });
        });
    </script>
</body>
</html>
